@model YachtCRM.Domain.Customer
@{
  ViewData["Title"] = "Customer Details";
}
@if (TempData["Flash"] is string msg) { <div class="alert alert-success">@msg</div> }

<div class="card shadow-sm mb-3">
  <div class="card-body">
    <h3 class="card-title">@Model.Name</h3>
    <p class="mb-1"><strong>Email:</strong> @Model.Email</p>
    <p class="mb-1"><strong>Phone:</strong> @Model.Phone</p>
    <p class="mb-0"><strong>Country:</strong> @Model.Country</p>
    <div class="mt-3">
      <a class="btn btn-warning" asp-action="Edit" asp-route-id="@Model.CustomerID">Edit</a>
      <a class="btn btn-outline-danger" asp-action="Delete" asp-route-id="@Model.CustomerID">Delete</a>
      <a class="btn btn-outline-secondary" asp-action="Index">Back</a>
    </div>
  </div>
</div>

<div class="row g-3">
  <div class="col-lg-6">
    <div class="card shadow-sm h-100">
      <div class="card-body">
        <h5 class="card-title">Projects (@Model.Projects.Count)</h5>
        @if (!Model.Projects.Any()) { <p class="text-muted mb-0">No projects.</p> }
        else {
          <ul class="list-group list-group-flush">
            @foreach (var p in Model.Projects)
            {
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <span>@p.Name</span>
                <a class="btn btn-sm btn-primary" asp-controller="Projects" asp-action="Details" asp-route-id="@p.ProjectID">Open</a>
              </li>
            }
          </ul>
        }
      </div>
    </div>
  </div>
  <div class="col-lg-6">
    <div class="card shadow-sm h-100">
      <div class="card-body">
        <h5 class="card-title">Interactions (@Model.Interactions.Count)</h5>
        @if (!Model.Interactions.Any()) { <p class="text-muted mb-0">No interactions.</p> }
        else {
          <ul class="list-group list-group-flush">
            @foreach (var i in Model.Interactions.OrderByDescending(x => x.OccurredOn).Take(10))
            {
              <li class="list-group-item">
                <strong>@i.Type</strong> â€” @i.OccurredOn.ToLocalTime():g
                <div class="text-muted small">@i.Notes</div>
              </li>
            }
          </ul>
        }
      </div>
    </div>
  </div>
</div>
